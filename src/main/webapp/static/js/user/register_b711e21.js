"use strict";var Promise=require("node_modules/es6-promise/dist/es6-promise").Promise;require("node_modules/whatwg-fetch/fetch");var urlValidUserName=urlPrefix+"/fn/valid/username",formRegister=new Vue({el:"#formRegister",data:{username:"",password:"",passConfirm:"",usernameError:!1,passError:!1},computed:{errorCount:function(){var r=0;return this.usernameError&&r++,this.passError&&r++,r},errorMsg:function(){var r="";return this.usernameError?r="抱歉，用户名已被注册":this.passError&&(r="两次密码输入不一致"),r},hasError:function(){return this.usernameError||this.passError}},methods:{validName:function(){fetch(urlValidUserName,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({username:formRegister.username})}).then(function(r){return r.json()}).then(function(r){formRegister.usernameError="ok"==r.code?!1:!0})["catch"](function(r){console.log("request failed",r)})},validPass:function(){return this.passError=!(this.password===this.passConfirm),this.passError},validRegister:function(){fetch(urlValidUserName,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:formRegister.username})}).then(function(r){return r.json()}).then(function(r){"ok"==r.code?(formRegister.usernameError=!1,formRegister.validPass()):formRegister.usernameError=!0,formRegister.hasError||formRegister.$el.submit()})["catch"](function(r){console.log("request failed",r)})}}});