"use strict";function loadProject(){if(!this.noMore){var e=urlSearchProject+"?pageNum="+this.pageNum+"&pageSize="+this.pageSize+"&keyWords="+this.keyWords+"&userid="+this.user.id;this.busy=!0,this.isLoading=!0,self=this,fetch(e,{method:"GET",headers:{Accept:"application/json"}}).then(function(e){return e.json()}).then(function(e){self.isLoading=!1,self.projects=0===self.pageNum?e.projects:self.projects.concat(e.projects),e.hasMore===!1&&(self.noMore=!0),self.pageNum++,self.busy=!1})}}function loadHotProject(){var e=urlSearchHotProject+"?hotSize="+this.hotSize+"&keyWords="+this.keyWords+"&userid="+this.user.id;self=this,fetch(e,{method:"GET",headers:{Accept:"application/json"}}).then(function(e){return e.json()}).then(function(e){e.projects.map(function(e){return e.isHot=!0,e}),self.hotProjects=e.projects})}var infiniteScroll=require("node_modules/vue-infinite-scroll/vue-infinite-scroll").infiniteScroll,Promise=require("node_modules/es6-promise/dist/es6-promise").Promise;require("node_modules/whatwg-fetch/fetch");var urlSearchProject=urlPrefix+"/fn/get/project",urlSearchHotProject=urlPrefix+"/fn/get/hotProject",urlCollect=urlPrefix+"/fn/project/collect",urlUnCollect=urlPrefix+"/fn/project/uncollect",bus=new Vue;bus.$on("loadProject",function(e){projectBox.pageNum=1,projectBox.keyWords=e,projectBox.projects.splice(0,projectBox.projects.length),projectBox.hotProjects.splice(0,projectBox.hotProjects.length),projectBox.noMore=!1,projectBox.busy=!1,projectBox.isLoading=!1,projectBox.checkImmediately=!1,projectBox.collectIsFail=!1,projectBox.loadProject(),projectBox.loadHotProject()}),Vue.component("tic-project",{template:"#tic-project",props:["project","index","userid"],methods:{collect:function(e){this.$emit("collect",e.projectIndex);var o=this,t=urlCollect+"?userid="+e.userid+"&proId="+this.project.proId;fetch(t,{method:"GET",headers:{Accept:"application/json"}}).then(function(e){return e.json()}).then(function(t){"error"===t.code&&(o.$emit("uncollect",e.projectIndex),o.$emit("collectFail"))})},uncollect:function(e){this.$emit("uncollect",e.projectIndex);var o=this,t=urlUnCollect+"?userid="+e.userid+"&proId="+this.project.proId;fetch(t,{method:"GET",headers:{Accept:"application/json"}}).then(function(e){return e.json()}).then(function(t){"error"===t.code&&(o.$emit("collect",e.projectIndex),o.$emit("collectFail"))})}}});var projectBox=new Vue({el:"#appBody",data:{projects:[],hotProjects:[],busy:!1,noMore:!1,isLoading:!1,checkImmediately:!1,collectIsFail:!1,pageNum:0,pageSize:5,hotSize:2,keyWords:"",user:userInfo},beforeMount:function(){this.loadHotProject(),this.loadProject()},methods:{loadProject:loadProject,loadHotProject:loadHotProject,collect:function(e){this.projects[e].isCollected=!0},collectHot:function(e){this.hotProjects[e].isCollected=!0},uncollect:function(e){this.projects[e].isCollected=!1},uncollectHot:function(e){this.hotProjects[e].isCollected=!1},closeDialog:function(){this.collectIsFail=!1},openDialog:function(){this.collectIsFail=!0}},directives:{infiniteScroll:infiniteScroll}}),searchBar=new Vue({el:"#searchBar",data:{keyWords:"",isFocusing:!1},methods:{showInput:function(){this.isFocusing=!0,this.$nextTick(function(){this.$el.querySelector("#searchInput").focus()})},inputBlur:function(){this.keyWords.length||(this.isFocusing=!1)},clearInput:function(){this.keyWords=""},cancelSearch:function(){this.keyWords="",this.isFocusing=!1},search:function(){bus.$emit("loadProject",this.keyWords)}}});