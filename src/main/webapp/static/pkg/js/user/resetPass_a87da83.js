;/*!/static/js/user/resetPass.js*/
"use strict";var Promise=require("node_modules/es6-promise/dist/es6-promise").Promise;require("node_modules/whatwg-fetch/fetch");var urlValidUserName=urlPrefix+"/fn/valid/user",formResetPass=new Vue({el:"#formResetPass",data:{username:"",passOld:"",passNew:"",passNewConfirm:"",userError:!1,passError:!1},computed:{errorCount:function(){var s=0;return this.userError&&s++,this.passError&&s++,s},errorMsg:function(){var s="";return this.userError?s="用户名或原始密码错误":this.passError&&(s="两次新密码输入不一致"),s},hasError:function(){return this.userError||this.passError}},methods:{validUser:function(){fetch(urlValidUserName,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({username:formResetPass.username,password:formResetPass.passOld})}).then(function(s){return s.json()}).then(function(s){formResetPass.userError="ok"==s.code?!1:!0})["catch"](function(s){console.log("request failed",s)})},validPass:function(){return this.passError=!(this.passNew===this.passNewConfirm),this.passError},validForm:function(){fetch(urlValidUserName,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:formResetPass.username,password:formResetPass.passOld})}).then(function(s){return s.json()}).then(function(s){"ok"==s.code?(formResetPass.userError=!1,formResetPass.validPass()):formResetPass.userError=!0,formResetPass.hasError||formResetPass.$el.submit()})["catch"](function(s){console.log("request failed",s)})},navBack:function(){window.history.go(-1)}}});